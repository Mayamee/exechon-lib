function [Q] = xoy_inverse(P_real,disp)
	F2 = [0,0];
	L1 = 125;
	L2 = 150;
	%base init
	xA1 = -85;
	yA1 = 0;
	zA1 = 0;
	
	xA2 = 0;
	yA2 = 100;
	zA2 = 0;
	
	xA3 = 85;
	yA3 = 0;
	zA3 = 0;
	%base init
	d_B1B3 = 130;
	de = 65;
	% dBiBj is the fixed distance between Bi and Bj, 
	% de is the constant distance from B2 to B1 B3 in the Oxy plane.
	% init
	opts = optimoptions(@fsolve,'Display',disp,'MaxFunEvals',25000000, 'MaxIter',25000000,'TolFun',1E-10,'TolX',1E-10);
	f = @(x)[
		x(1) - L2*((cos(x(5))*sin(x(4)))/((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2) - (sin(x(5))*(xA2 - x(1)))/(((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2))) + (L1*(xA2 - x(1)))/(((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2)) - P_real(1);
		x(2) + L2*(cos(x(5))*(cos(x(4))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*sin(x(4))*(xA2 - x(1)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)*((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2))) + (x(2)*sin(x(5)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2))) + (L1*x(2))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2)) - P_real(2);
		x(3) - L2*(cos(x(5))*((x(2)*cos(x(4)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)) - (sin(x(4))*(xA2 - x(1)))/((x(2)^2/x(3)^2 + 1)^(1/2)*((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2))) - sin(x(5))/((x(2)^2/x(3)^2 + 1)^(1/2)*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2))) + L1/((x(2)^2/x(3)^2 + 1)^(1/2)*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2)) - P_real(3);
		sin(x(4))/(x(2)^2/x(3)^2 + 1)^(1/2) - (x(2)*cos(x(4))*(xA2 - x(1)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)*((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2)) - F2(1);
		cos(x(5))*(cos(x(4))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*sin(x(4))*(xA2 - x(1)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)*((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2))) + (x(2)*sin(x(5)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)*((xA2 - x(1))^2/((zA2 - x(3))/(x(2)^2/x(3)^2 + 1)^(1/2) + (x(2)*(yA2 - x(2)))/(x(3)*(x(2)^2/x(3)^2 + 1)^(1/2)))^2 + 1)^(1/2)) - F2(2);
	];
	x0 = [100 100 200 0.5 0.5];
	SOL = fsolve(f,x0,opts);
	xe = SOL(1);
	ye = SOL(2);
	ze = SOL(3);
	A1 = [xA1;yA1;zA1;];
	A2 = [xA2;yA2;zA2;];
	A3 = [xA3;yA3;zA3;];
	alf = atan(-ye/ze);
	k3 = atan((xe-xA2)/((ze-zA2)*cos(alf)-(ye-yA2)*sin(alf)));
	B1 = [
		xe-d_B1B3*cos(k3)/2;
		ye-d_B1B3*sin(alf)*sin(k3)/2;
		ze+d_B1B3*cos(alf)*sin(k3)/2;
	];
	B3 = [
		xe+d_B1B3*cos(k3)/2;
		ye+d_B1B3*sin(alf)*sin(k3)/2;
		ze-d_B1B3*cos(alf)*sin(k3)/2;
	];
	B2 = [
		xe;
		ye+de*cos(alf);
		ze+de*sin(alf);
	];
	Q1= sqrt((A1(1)-B1(1))^2+(A1(2)-B1(2))^2+(A1(3)-B1(3))^2);
	Q2= sqrt((A2(1)-B2(1))^2+(A2(2)-B2(2))^2+(A2(3)-B2(3))^2);
	Q3= sqrt((A3(1)-B3(1))^2+(A3(2)-B3(2))^2+(A3(3)-B3(3))^2);
	Q4 = SOL(4);
	Q5 = SOL(5);
	Q = [Q1 Q2 Q3 Q4 Q5];
	end
	
	